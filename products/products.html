<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>제품 관리 - 깜냥컴퓨터</title>
    <link rel="stylesheet" href="/style.css?v=20250111">
</head>
<body>
    <!-- 네비게이션 바 -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="../shared/index.html" class="nav-brand">깜냥컴퓨터</a>
            <ul class="nav-menu">
                <li><a href="../shared/index.html">홈</a></li>
                <li><a href="../customers/customers.html">고객</a></li>
                <li><a href="products.html" class="active">제품</a></li>
                <li><a href="#" onclick="alert('장부 관리 페이지 (개발 예정)')">장부</a></li>
                <li><a href="#" onclick="alert('회계 관리 페이지 (개발 예정)')">회계</a></li>
                <li><a href="#" onclick="alert('설정 페이지 (개발 예정)')">설정</a></li>
            </ul>
            <div class="user-info">
                <span id="userName">사용자</span>
                <button onclick="logout()" class="btn btn-outline">로그아웃</button>
            </div>
        </div>
    </nav>

    <!-- 제품 관리 화면 -->
    <div class="products-page">
        <div class="page-header">
            <h1>제품 관리</h1>
        </div>
        
        <div class="search-filter">
            <input type="text" id="productSearch" placeholder="제품명, 브랜드로 검색..." onkeyup="searchProducts()" class="form-control">
            <select id="mainCategoryFilter" onchange="updateSubCategories()" class="form-control">
                <option value="">전체 카테고리</option>
            </select>
            <select id="subCategoryFilter" onchange="updateDetailCategories()" disabled class="form-control">
                <option value="">하위 카테고리</option>
            </select>
            <select id="detailCategoryFilter" onchange="filterProducts()" disabled class="form-control">
                <option value="">상세 카테고리</option>
            </select>
            <select id="statusFilter" onchange="filterProducts()" class="form-control">
                <option value="">전체 상태</option>
                <option value="정품">정품</option>
                <option value="벌크">벌크</option>
                <option value="직구">직구</option>
                <option value="중고">중고</option>
            </select>
            <button class="btn btn-primary" onclick="window.open('product-add.html', '_blank', 'width=900,height=800,scrollbars=yes,resizable=yes')">+ 새 제품 등록</button>
            <button class="btn btn-outline" onclick="showCategoryModal()" title="새 카테고리를 추가합니다">
                <span class="btn-icon">📁</span> 카테고리 추가
            </button>
        </div>
        
        <div class="products-table-container">
            <table class="products-table">
                <thead>
                <tr>
                    <th>제품코드</th>
                    <th>제품명</th>
                    <th>카테고리</th>
                    <th>브랜드</th>
                    <th>가격</th>
                    <th>재고</th>
                    <th>상태</th>
                    <th>액션</th>
                </tr>
                </thead>
                <tbody id="productsTableBody" style="text-align: center;"> 
                    <!-- 제품 데이터가 여기에 동적으로 추가됩니다 -->
                </tbody>
            </table>
        </div>
        
        <div class="pagination" id="pagination">
            <!-- 페이지네이션이 여기에 동적으로 추가됩니다 -->
        </div>
    </div>

    <!-- 제품 등록/수정 모달 -->
    <div class="modal" id="productModal" style="display: none;">
        <div class="modal-content" style="max-width: 800px; max-height: 90vh; display: flex; flex-direction: column;">
            <div class="modal-header" style="flex-shrink: 0;">
                <h2 id="productModalTitle">제품 등록</h2>
                <button class="close-btn" onclick="closeProductModal()">&times;</button>
            </div>
            <div class="modal-body" style="flex: 1; overflow-y: auto; padding: 20px; max-height: calc(90vh - 120px); scrollbar-width: thin; scrollbar-color: #ced4da #f8f9fa;">
                <form id="productForm">
                <div class="form-row">
                    <div class="form-group">
                        <label for="productName">제품명 *</label>
                        <input type="text" id="productName" name="name" required>
                    </div>
                    <div class="form-group">
                        <label for="productCode">제품 코드</label>
                        <input type="text" id="productCode" name="productCode" placeholder="제품 코드 입력">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="productMainCategory" class="required">대분류 *</label>
                        <select id="productMainCategory" name="mainCategory" required onchange="updateProductSubCategories()" class="form-control">
                            <option value="">대분류를 선택하세요</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="productSubCategory">중분류</label>
                        <select id="productSubCategory" name="subCategory" onchange="updateProductDetailCategories()" disabled class="form-control">
                            <option value="">중분류를 선택하세요</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="productDetailCategory">소분류</label>
                        <select id="productDetailCategory" name="detailCategory" disabled class="form-control">
                            <option value="">소분류를 선택하세요</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="productBrand">브랜드 *</label>
                        <input type="text" id="productBrand" name="brand" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="productPrice">가격 *</label>
                        <input type="number" id="productPrice" name="price" min="0" required>
                    </div>
                    <div class="form-group">
                        <label for="productStock">재고수량 *</label>
                        <input type="number" id="productStock" name="stockQuantity" min="0" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="productStatus">상태</label>
                        <select id="productStatus" name="status">
                            <option value="정품">정품</option>
                            <option value="벌크">벌크</option>
                            <option value="중고">중고</option>
                            <option value="직구">직구</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="productImage">제품 이미지</label>
                    <input type="file" id="productImage" name="image" accept="image/*" onchange="previewImage(this)">
                    <div id="imagePreview" style="margin-top: 10px; display: none;">
                        <img id="previewImg" style="max-width: 200px; max-height: 200px; border-radius: 4px;">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="productDescription">제품 설명</label>
                    <textarea id="productDescription" name="description" rows="4" placeholder="제품의 상세 설명을 입력하세요"></textarea>
                </div>
                
                </form>
            </div>
            <div class="modal-footer" style="flex-shrink: 0; padding: 20px; border-top: 1px solid #e9ecef; background: #f8f9fa;">
                <div class="form-actions" style="display: flex; gap: 10px; justify-content: flex-end;">
                    <button type="button" class="btn btn-outline" onclick="closeProductModal()">취소</button>
                    <button type="submit" form="productForm" class="btn btn-primary">저장</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 제품 상세 모달 -->
    <div class="modal" id="productDetailModal" style="display: none;">
        <div class="modal-content" style="max-width: 1200px; max-height: 90vh; display: flex; flex-direction: column;">
            <div class="modal-header" style="flex-shrink: 0; display: flex; justify-content: space-between; align-items: center; padding: 20px; border-bottom: 1px solid #e9ecef; background: #f8f9fa;">
                <h2 style="margin: 0; color: #333;">제품 상세 정보</h2>
                <button class="close-btn" onclick="closeProductDetailModal()" style="background: none; border: none; font-size: 24px; cursor: pointer; color: #666;">&times;</button>
            </div>
            <div id="productDetailContent" style="flex: 1; overflow-y: auto; padding: 30px; max-height: calc(90vh - 80px); scrollbar-width: thin; scrollbar-color: #ced4da #f8f9fa;">
                <!-- 제품 상세 정보가 여기에 동적으로 추가됩니다 -->
            </div>
        </div>
    </div>

    <!-- 카테고리 추가 모달 -->
    <div class="modal" id="categoryModal" style="display: none;">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h2>카테고리 추가</h2>
                <button class="close-btn" onclick="closeCategoryModal()">&times;</button>
            </div>
            <form id="categoryForm">
                <div class="form-group">
                    <label for="categoryLevel" class="required">카테고리 레벨</label>
                    <select id="categoryLevel" name="level" required onchange="updateCategoryForm()" class="form-control">
                        <option value="">레벨을 선택하세요</option>
                        <option value="main">🏢 대분류 추가</option>
                        <option value="sub">📂 중분류 추가</option>
                        <option value="detail">📁 소분류 추가</option>
                    </select>
                </div>
                
                <div class="form-group" id="parentCategoryGroup" style="display: none;">
                    <label for="parentCategory" class="required">상위 카테고리</label>
                    <select id="parentCategory" name="parentCategory" class="form-control">
                        <option value="">상위 카테고리를 선택하세요</option>
                    </select>
                </div>
                
                <div class="form-group" id="subParentCategoryGroup" style="display: none;">
                    <label for="subParentCategory" class="required">중분류 선택</label>
                    <select id="subParentCategory" name="subParentCategory" class="form-control">
                        <option value="">중분류를 선택하세요</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="categoryName" class="required">카테고리명</label>
                    <input type="text" id="categoryName" name="categoryName" required placeholder="새 카테고리명을 입력하세요" class="form-control">
                </div>
                
                <div class="form-group">
                    <label for="categoryDescription">설명 (선택사항)</label>
                    <textarea id="categoryDescription" name="categoryDescription" rows="3" placeholder="카테고리에 대한 설명을 입력하세요" class="form-control"></textarea>
                </div>
                
                <div class="form-actions">
                    <button type="button" class="btn btn-outline" onclick="closeCategoryModal()">
                        <span class="btn-icon">❌</span> 취소
                    </button>
                    <button type="submit" class="btn btn-primary">
                        <span class="btn-icon">✅</span> 카테고리 추가
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script src="category-manager.js"></script>
    <style>
        /* 제품 모달 스크롤바 스타일 */
        .modal-body::-webkit-scrollbar,
        #productDetailContent::-webkit-scrollbar {
            width: 8px;
        }
        
        .modal-body::-webkit-scrollbar-track,
        #productDetailContent::-webkit-scrollbar-track {
            background: #f8f9fa;
            border-radius: 4px;
        }
        
        .modal-body::-webkit-scrollbar-thumb,
        #productDetailContent::-webkit-scrollbar-thumb {
            background: #ced4da;
            border-radius: 4px;
        }
        
        .modal-body::-webkit-scrollbar-thumb:hover,
        #productDetailContent::-webkit-scrollbar-thumb:hover {
            background: #adb5bd;
        }
        
        /* 스크롤바가 나타날 때만 표시 */
        .modal-body,
        #productDetailContent {
            scrollbar-gutter: stable;
        }
        
        /* 제품 상세 모달 스크롤바 스타일 */
        #productDetailContent::-webkit-scrollbar {
            width: 8px;
        }
        
        #productDetailContent::-webkit-scrollbar-track {
            background: #f8f9fa;
            border-radius: 4px;
        }
        
        #productDetailContent::-webkit-scrollbar-thumb {
            background: #ced4da;
            border-radius: 4px;
        }
        
        #productDetailContent::-webkit-scrollbar-thumb:hover {
            background: #adb5bd;
        }
        
        /* 재고 상태별 색상 스타일 */
        .stock-negative {
            color: #ff6b6b !important;
            font-weight: bold;
        }
        
        .stock-empty {
            color: #dc3545 !important;
            font-weight: bold;
        }
        
        .stock-available {
            color: #28a745 !important;
            font-weight: bold;
        }
        
        /* 제품 테이블 컨테이너 스타일 */
        .products-table-container {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin-top: 20px;
        }
        
        /* 제품 테이블 스타일 */
        .products-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0 8px;
            margin-top: 10px;
            table-layout: fixed;
        }
        
        .products-table thead {
            background: white;
        }
        
        .products-table thead th {
            padding: 15px 10px;
            text-align: left;
            font-weight: 600;
            color: #495057;
            background: #f8f9fa;
            border-bottom: 2px solid #dee2e6;
        }
        
        /* 각 열 너비 설정 - 필요에 따라 수정하세요 */
        .products-table thead th:nth-child(1),  /* 제품코드 */
        .products-table tbody td:nth-child(1) {
            width: 10%;
        }
        
        .products-table thead th:nth-child(2),  /* 제품명 */
        .products-table tbody td:nth-child(2) {
            width: 30%;
        }
        
        .products-table thead th:nth-child(3),  /* 카테고리 */
        .products-table tbody td:nth-child(3) {
            width: 10%;
        }
        
        .products-table thead th:nth-child(4),  /* 브랜드 */
        .products-table tbody td:nth-child(4) {
            width: 10%;
        }
        
        .products-table thead th:nth-child(5),  /* 가격 */
        .products-table tbody td:nth-child(5) {
            width: 10%;
        }
        
        .products-table thead th:nth-child(6),  /* 재고 */
        .products-table tbody td:nth-child(6) {
            width: 8%;
        }
        
        .products-table thead th:nth-child(7),  /* 상태 */
        .products-table tbody td:nth-child(7) {
            width: 10%;
        }
        
        .products-table thead th:nth-child(8),  /* 액션 */
        .products-table tbody td:nth-child(8) {
            width: 12%;
        }
        
        .products-table thead th:first-child {
            border-top-left-radius: 8px;
        }
        
        .products-table thead th:last-child {
            border-top-right-radius: 8px;
        }
        
        /* 제품 테이블 셀 카드 스타일 */
        .products-table tbody td {
            padding: 15px 10px;
            vertical-align: middle;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .products-table tbody td:not(:last-child) {
            background: #f8f9fa;
            border-right: 1px solid #e9ecef;
        }
        
        .products-table tbody tr {
            background: white;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .products-table tbody tr td:first-child {
            border-top-left-radius: 8px;
            border-bottom-left-radius: 8px;
        }
        
        .products-table tbody tr td:last-child {
            background: white;
            border-top-right-radius: 8px;
            border-bottom-right-radius: 8px;
        }
        
        .product-info-cell {
            background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
            padding: 12px 15px;
            border-radius: 6px;
            margin: 2px 0;
        }
        
        .product-code-cell {
            background: linear-gradient(135deg, #e7f5ff 0%, #ffffff 100%);
            border-left: 3px solid #007bff;
        }
        
        .product-name-cell {
            background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
            font-weight: 600;
            color: #333;
        }
        
        .product-category-cell {
            background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
        }
        
        .product-brand-cell {
            background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
        }
        
        .product-price-cell {
            background: linear-gradient(135deg, #e8f5e9 0%, #ffffff 100%);
            color: #28a745;
            font-weight: bold;
            border-left: 3px solid #28a745;
        }
        
        .product-stock-cell {
            background: linear-gradient(135deg, #fff3e0 0%, #ffffff 100%);
            font-weight: bold;
            border-left: 3px solid #ff9800;
        }
        
        .product-status-cell {
            background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
        }
        
        .product-action-cell {
            background: white;
        }
    </style>

    <script src="products.js"></script>
</body>
</html>
